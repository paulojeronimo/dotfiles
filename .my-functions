#!/bin/bash
# Author: Paulo JerÃ´nimo (@paulojeronimo, pj@paulojeronimo.info)
# Some utility functions

# Specific dot file loaded by .bashrc or .profile for this system
export DOTSTART_FILE=~/.`hostname -s`

# Change some defaults for specific systems
sed_i() {
   case `uname` in
      Darwin) sed -i "" "$@";;
      Linux|Cygwin) sed -i "$@";;
   esac
}

# Insert code on .profile (or .bashrc) to load $DOTSTART_FILE file
dotstart_install() {
   local profile=~/.profile
   local search_str='# Load startup environment for this machine'

   case `uname` in
      Linux)
         profile=~/.bashrc
         ;;
   esac

   [ -f $profile ] || touch $profile

   grep "^$search_str" $profile &> /dev/null
   if [ $? = 1 ]; then
      echo "Changing $profile to load $DOTSTART_FILE file ..."
      echo -e "\n$search_str" >> $profile
      echo -e "f=$DOTSTART_FILE; [ -f \"\$f\" ] && source \"\$f\"" >> $profile
   fi
}

# Show PATH, one per line
showpath() {
   echo $PATH | tr : '\n'
}

# Change the loaded environment configured at this file
setenv() {
  local env=$1

  if [ -f "$env" ]; then
    sed_i "s,^\(export ENVIRONMENT=\)\(.*\),\1\"$env\",g" $DOTSTART_FILE
  else
    echo "The file \"$env\" does'nt exists! Nothing was done."
  fi
}
